(function(f){var g=function(a,b){return f.extend(document.createElement(a),b)},n=window.VanillaTree=function(a,b){var c=this,d=c.container=f(a)[0],d=c.tree=d.appendChild(g("ul",{className:"vtree"}));c.placeholder=b&&b.placeholder;c._placeholder();d.addEventListener("click",function(a){f(a.target).is(".vtree-leaf-label")?c.select(a.target.parentNode.getAttribute("data-vtree-id")):f(a.target).is(".vtree-toggle")&&c.toggle(a.target.parentNode.getAttribute("data-vtree-id"))});b&&b.contextmenu&&(d.addEventListener("contextmenu",
function(a){var c;f(".vtree-contextmenu").forEach(function(a){a.parentNode.removeChild(a)});f(a.target).is(".vtree-leaf-label")&&(a.preventDefault(),a.stopPropagation(),c=g("menu",{className:"vtree-contextmenu"}),f.extend(c.style,{top:a.offsetY,left:a.offsetX+18,display:"block"}),b.contextmenu.forEach(function(b){c.appendChild(g("li",{className:"vtree-contextmenu-item",innerHTML:b.label})).addEventListener("click",b.action.bind(b,a.target.parentNode.getAttribute("data-vtree-id")))}),a.target.parentNode.appendChild(c))}),
document.addEventListener("click",function(a){f(".vtree-contextmenu").forEach(function(a){a.parentNode.removeChild(a)})}))};n.prototype={constructor:n,_dispatch:function(a,b){var c;try{c=new CustomEvent("vtree-"+a,{bubbles:!0,cancelable:!0,detail:{id:b}})}catch(d){c=document.createEvent("CustomEvent"),c.initCustomEvent("vtree-"+a,!0,!0,{id:b})}(this.getLeaf(b,!0)||this.tree).dispatchEvent(c);return this},_placeholder:function(){var a;!this.tree.children.length&&this.placeholder?this.tree.innerHTML=
'<li class="vtree-placeholder">'+this.placeholder+"</li>":(a=this.tree.querySelector(".vtree-placeholder"))&&this.tree.removeChild(a);return this},getLeaf:function(a,b){var c=f('[data-vtree-id="'+a+'"]',this.tree)[0];if(!b&&!c)throw Error('No VanillaTree leaf with id "'+a+'"');return c},getChildList:function(a){var b;a?(b=this.getLeaf(a),(a=f("ul",b)[0])||(a=b.appendChild(g("ul",{className:"vtree-subtree"})))):a=this.tree;return a},add:function(a){var b,c=g("li",{className:"vtree-leaf"}),d=this.getChildList(a.parent);
c.setAttribute("data-vtree-id",b=a.id||Math.random());c.appendChild(g("span",{className:"vtree-toggle"}));c.appendChild(g("a",{className:"vtree-leaf-label",innerHTML:a.label}));d.appendChild(c);d!==this.tree&&d.parentNode.classList.add("vtree-has-children");a.opened||this.close(b);a.selected&&this.select(b);return this._placeholder()._dispatch("add",b)},move:function(a,b){var c=this.getLeaf(a),d=c.parentNode,e=this.getLeaf(b,!0);e&&e.classList.add("vtree-has-children");this.getChildList(b).appendChild(c);
d.parentNode.classList.toggle("vtree-has-children",!!d.children.length);return this._dispatch("move",a)},remove:function(a){var b=this.getLeaf(a),c=b.parentNode;c.removeChild(b);c.parentNode.classList.toggle("vtree-has-children",!!c.children.length);return this._placeholder()._dispatch("remove",a)},open:function(a){this.getLeaf(a).classList.remove("closed");return this._dispatch("open",a)},close:function(a){this.getLeaf(a).classList.add("closed");return this._dispatch("close",a)},toggle:function(a){return this[this.getLeaf(a).classList.contains("closed")?
"open":"close"](a)},select:function(a){var b=this.getLeaf(a);b.classList.contains("vtree-selected")||(f("li.vtree-leaf",this.tree).forEach(function(a){a.classList.remove("vtree-selected")}),b.classList.add("vtree-selected"),this._dispatch("select",a));return this}}})(function(f,g,n,a,b,c,d,e,h,m,l,k){k=function(a,b){return new k.i(a,b)};k.i=function(a,b){n.push.apply(this,a?a.nodeType||a==f?[a]:""+a===a?/</.test(a)?((e=g.createElement(b||"div")).innerHTML=a,e.children):(b&&k(b)[0]||g).querySelectorAll(a):
/f/.test(typeof a)?/c/.test(g.readyState)?a():k(g).on("DOMContentLoaded",a):a:n)};k.i[l="prototype"]=(k.extend=function(a){m=arguments;for(e=1;e<m.length;e++)if(l=m[e])for(h in l)a[h]=l[h];return a})(k.fn=k[l]=n,{on:function(d,f){d=d.split(a);this.map(function(g){(a[e]=a[e=d[0]+(g.b$=g.b$||++b)]||[]).push([f,d[1]]);g["add"+c](d[0],f)});return this},off:function(b,d){b=b.split(a);l="remove"+c;this.map(function(c){if(e=(m=a[b[0]+c.b$])&&m.length)for(;h=m[--e];)d&&d!=h[0]||b[1]&&b[1]!=h[1]||(c[l](b[0],
h[0]),m.splice(e,1));else c[l](b[0],d)});return this},is:function(a){e=this[0];h=!!e&&(e.matches||e["webkit"+d]||e["moz"+d]||e["ms"+d]);return!!h&&h.call(e,a)}});return k}(window,document,[],/\.(.+)/,0,"EventListener","MatchesSelector"));
